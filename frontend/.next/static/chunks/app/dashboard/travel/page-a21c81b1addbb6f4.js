(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{33272:function(e,t,s){Promise.resolve().then(s.bind(s,95746))},42208:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},33245:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},99397:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},95746:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(57437),a=s(2265),n=s(27648),i=s(95932),l=s(19465),c=s(93448),o=s(3964),d=s(99397),u=s(76865),h=s(42208);let f={draft:"neutral",submitted:"primary",manager_approved:"success",manager_rejected:"danger",booked:"success",completed:"neutral",cancelled:"danger"},x={draft:"Draft",submitted:"Pending Approval",manager_approved:"Approved",manager_rejected:"Rejected",booked:"Booked",completed:"Completed",cancelled:"Cancelled"};function p(){let{user:e}=(0,i.aC)(),[t,s]=(0,a.useState)([]),[p,m]=(0,a.useState)(!0),[v,g]=(0,a.useState)(null);return((0,a.useEffect)(()=>{(async()=>{try{let e=await l.x1.get("/travel/my");s(e.data.data||[])}catch(s){var e,t;g((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load travel requests")}finally{m(!1)}})()},[]),p)?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)(o.$j,{size:"lg"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-surface-100",children:"Travel Requests"}),(0,r.jsx)("p",{className:"text-surface-400 mt-1",children:"Manage your travel requests"})]}),(0,r.jsx)(n.default,{href:"/dashboard/travel/new",children:(0,r.jsxs)(o.zx,{children:[(0,r.jsx)(d.Z,{className:"h-4 w-4"}),"New Request"]})})]}),v&&(0,r.jsx)("div",{className:"p-4 bg-danger-600/10 border border-danger-600/30 rounded-xl",children:(0,r.jsx)("p",{className:"text-sm text-danger-500",children:v})}),0===t.length?(0,r.jsx)(o.Zb,{children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-surface-400",children:"No travel requests yet."}),(0,r.jsx)(n.default,{href:"/dashboard/travel/new",children:(0,r.jsx)(o.zx,{className:"mt-4",children:"Create your first request"})})]})}):(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,r.jsx)(o.Zb,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-surface-100",children:e.destination}),(0,r.jsx)(o.Ct,{variant:f[e.status],children:x[e.status]}),e.violations.length>0&&(0,r.jsxs)(o.Ct,{variant:"warning",children:[(0,r.jsx)(u.Z,{className:"h-3 w-3 mr-1"}),e.violations.length," violation(s)"]})]}),(0,r.jsxs)("div",{className:"text-sm text-surface-400 space-y-1",children:[(0,r.jsxs)("p",{children:[(0,c.p6)(e.startDate)," â€“ ",(0,c.p6)(e.endDate)]}),(0,r.jsxs)("p",{children:["Estimated: ",(0,c.xG)(e.estimatedCost)]}),(0,r.jsx)("p",{className:"line-clamp-1",children:e.purpose})]})]}),(0,r.jsx)(n.default,{href:"/dashboard/travel/".concat(e._id),children:(0,r.jsxs)(o.zx,{variant:"secondary",size:"sm",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4"}),"View"]})})]})},e._id))})]})}},14362:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},useAuth:function(){return d}});var r=s(57437),a=s(2265),n=s(14474),i=s(37994),l=s(42590);let c=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),h=(0,a.useCallback)(e=>{try{return(0,n.o)(e)}catch(e){return null}},[]),f=(0,a.useCallback)(async()=>{try{let e=await l.Z.get("/auth/profile");e.data.success&&o(e.data.data)}catch(e){(0,i.yE)(),o(null)}},[]);(0,a.useEffect)(()=>{(async()=>{let e=(0,i.lz)();if(null==e?void 0:e.accessToken){let t=h(e.accessToken);if(t&&1e3*t.exp>Date.now())await f();else try{let t=(await l.Z.post("/auth/refresh",{refreshToken:e.refreshToken})).data.data;(0,i.d0)(t),await f()}catch(e){(0,i.yE)()}}u(!1)})()},[h,f]);let x=(0,a.useCallback)(async(e,t)=>{let s=await l.Z.post("/auth/login",{email:e,password:t});if(s.data.success){let{accessToken:e,refreshToken:t,user:r}=s.data.data;(0,i.d0)({accessToken:e,refreshToken:t}),o(r)}else throw Error(s.data.message||"Login failed")},[]),p=(0,a.useCallback)(()=>{let e=(0,i.lz)();(null==e?void 0:e.refreshToken)&&l.Z.post("/auth/logout",{refreshToken:e.refreshToken}).catch(()=>{}),(0,i.yE)(),o(null)},[]),m={user:s,role:(null==s?void 0:s.role)||null,isAuthenticated:!!s,isLoading:d,login:x,logout:p};return(0,r.jsx)(c.Provider,{value:m,children:t})}function d(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},98319:function(e,t,s){"use strict";s.d(t,{ToastProvider:function(){return f},useToast:function(){return d}});var r=s(57437),a=s(2265),n=s(41671),i=s(99388),l=s(33245),c=s(32489);let o=(0,a.createContext)(null);function d(){let e=(0,a.useContext)(o);if(!e)throw Error("useToast must be used within ToastProvider");return e}let u={success:n.Z,error:i.Z,info:l.Z},h={success:"bg-success-600/90 text-white",error:"bg-danger-600/90 text-white",info:"bg-primary-600/90 text-white"};function f(e){let{children:t}=e,[s,n]=(0,a.useState)([]),i=(0,a.useCallback)((e,t)=>{let s=Date.now().toString()+Math.random().toString(36).slice(2);n(r=>[...r,{id:s,type:e,message:t}]),setTimeout(()=>{n(e=>e.filter(e=>e.id!==s))},4e3)},[]),l=(0,a.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]);return(0,r.jsxs)(o.Provider,{value:{toast:{success:e=>i("success",e),error:e=>i("error",e),info:e=>i("info",e)}},children:[t,(0,r.jsx)("div",{className:"fixed bottom-6 right-6 z-[9999] flex flex-col gap-2 pointer-events-none",children:s.map(e=>{let t=u[e.type];return(0,r.jsxs)("div",{className:"pointer-events-auto flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg ".concat(h[e.type]," animate-slide-up min-w-[280px] max-w-[400px]"),children:[(0,r.jsx)(t,{className:"h-5 w-5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm flex-1",children:e.message}),(0,r.jsx)("button",{onClick:()=>l(e.id),className:"opacity-70 hover:opacity-100",children:(0,r.jsx)(c.Z,{className:"h-4 w-4"})})]},e.id)})})]})}},95932:function(e,t,s){"use strict";s.d(t,{aC:function(){return r.useAuth},pm:function(){return a.useToast}});var r=s(14362),a=s(98319)},19465:function(e,t,s){"use strict";s.d(t,{x1:function(){return r.Z}});var r=s(42590)},14474:function(e,t,s){"use strict";s.d(t,{o:function(){return a}});class r extends Error{}function a(e,t){let s;if("string"!=typeof e)throw new r("Invalid token specified: must be a string");t||(t={});let a=!0===t.header?0:1,n=e.split(".")[a];if("string"!=typeof n)throw new r(`Invalid token specified: missing part #${a+1}`);try{s=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var s;return s=t,decodeURIComponent(atob(s).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}catch(e){return atob(t)}}(n)}catch(e){throw new r(`Invalid token specified: invalid base64 for part #${a+1} (${e.message})`)}try{return JSON.parse(s)}catch(e){throw new r(`Invalid token specified: invalid json for part #${a+1} (${e.message})`)}}r.prototype.name="InvalidTokenError"}},function(e){e.O(0,[647,383,183,971,117,744],function(){return e(e.s=33272)}),_N_E=e.O()}]);